<!DOCTYPE html>
<html lang="en" class="bg-white">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shoope Products - Zya's Placeshop</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; }
    .product-card { transition: transform 0.3s ease, box-shadow 0.3s ease; }
    .product-card:hover { transform: translateY(-4px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
    .product-card:active { transform: scale(0.98); }
    .sticky-header { position: sticky; top: 0; background-color: white; z-index: 10; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); }
  </style>
</head>
<body class="bg-white text-black">
  <main class="max-w-full sm:max-w-2xl md:max-w-4xl mx-auto px-3 sm:px-4">
    <div id="headerContainer"></div>
    <section id="productsSection" class="grid grid-cols-2 gap-3 sm:gap-6 mb-20"></section>
  </main>
  <template id="product-card-template">
    <a href="#" target="_blank" class="product-card rounded-lg overflow-hidden border border-gray-200 hover:border-black transition-colors" data-product="">
      <div class="relative bg-gray-300 overflow-hidden" style="aspect-ratio: 1;">
        <img src="" alt="" class="w-full h-full object-cover">
        <div class="absolute top-2 right-2 bg-black text-white px-2 sm:px-3 py-1 rounded-full text-xs font-semibold badge"></div>
      </div>
      <div class="p-2 sm:p-4">
        <h3 class="font-bold text-sm sm:text-lg mb-1 title"></h3>
        <p class="text-gray-600 text-xs sm:text-sm mb-2 line-clamp-2 description"></p>
        <div class="flex items-center justify-between">
          <span class="text-sm sm:text-lg font-bold price"></span>
          <span class="text-xs bg-gray-100 px-2 py-1 rounded range"></span>
        </div>
      </div>
    </a>
  </template>
  <script>
    let productsData = [];
    
    function detectCategory() {
      const path = window.location.pathname.toLowerCase();
      return path.includes('tiktok') ? 'tiktok' : 'shoope';
    }

    async function loadCategoryTabs() {
      try {
        const response = await fetch('kategori.html');
        const html = await response.text();
        const container = document.getElementById('headerContainer');
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = html;
        const headerDiv = tempDiv.querySelector('#headerContainer');
        if (headerDiv) {
          container.replaceWith(headerDiv);
          // Setup tabs after loading
          setupCategoryTabsAfterLoad();
          // Setup search after loading
          setupSearch();
        }
      } catch (err) {
        console.error('Failed to load kategori.html:', err);
      }
    }

    function setupCategoryTabsAfterLoad() {
      const tabButtons = document.querySelectorAll('.category-tab-btn');
      const currentCategory = detectCategory();
      
      // Highlight active tab
      tabButtons.forEach(btn => {
        const category = btn.getAttribute('data-category');
        if (category === currentCategory) {
          btn.classList.add('text-red-600', 'border-red-600', 'active');
          btn.classList.remove('text-gray-600', 'border-transparent');
        } else {
          btn.classList.remove('text-red-600', 'border-red-600', 'active');
          btn.classList.add('text-gray-600', 'border-transparent');
        }
        
        // Add click listener
        btn.addEventListener('click', (e) => {
          const path = btn.getAttribute('data-path');
          window.location.pathname = path;
        });
      });
    }
    async function loadProducts() {
      try {
        const category = detectCategory();
        const jsonFile = category === 'tiktok' ? 'products_tiktok_0_250.json' : 'products_shoope_0_250.json';
        const response = await fetch(jsonFile);
        const data = await response.json();
        productsData = category === 'tiktok' ? data.tiktok : data.shoope;
        renderProducts();
      } catch (err) {
        console.error('Failed to load JSON:', err);
      }
    }
    function renderProducts() {
      const template = document.getElementById('product-card-template');
      const container = document.getElementById('productsSection');
      if (!template || !container) return;
      container.innerHTML = '';
      productsData.forEach((p, i) => {
        const el = template.content.firstElementChild.cloneNode(true);
        el.href = p.href;
        el.setAttribute('data-product', i + 1);
        el.querySelector('img').src = p.img;
        el.querySelector('img').alt = p.alt;
        const badgeEl = el.querySelector('.badge');
        if (p.badge && p.badge.trim() !== '') {
          badgeEl.textContent = p.badge;
        } else {
          badgeEl.remove();
        }
        el.querySelector('.title').textContent = p.title;
        el.querySelector('.description').textContent = p.description;
        el.querySelector('.price').textContent = p.price;
        el.querySelector('.range').textContent = p.range;
        container.appendChild(el);
      });
    }
    function setupSearch() {
      const searchInput = document.getElementById('searchProducts');
      if (!searchInput) return;
      searchInput.addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        document.querySelectorAll('[data-product]').forEach(card => {
          const title = card.querySelector('h3').textContent.toLowerCase();
          const description = card.querySelector('p').textContent.toLowerCase();
          card.style.display = (title.includes(searchTerm) || description.includes(searchTerm)) ? '' : 'none';
        });
      });
    }
    document.addEventListener('DOMContentLoaded', async () => {
      await loadCategoryTabs();
      await loadProducts();
    });
  </script>
</body>
</html>